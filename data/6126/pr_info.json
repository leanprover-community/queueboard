{
  "data": {
    "repository": {
      "pullRequest": {
        "additions": 7,
        "assignees": {
          "nodes": []
        },
        "author": {
          "login": "Vierkantor"
        },
        "autoMergeRequest": null,
        "baseRefName": "master",
        "body": "This PR modifies the definition of `IsIntegrallyClosed` to drop the `IsDomain` hypothesis. This change came out of the discussions of modifying `IsDedekindDomain` to either extend `IsDomain` or to drop `IsDomain` entirely and change it to `IsDedekindRing`. (The former being a dependency of this PR, the latter a follow-up.)\r\n\r\nZulip thread: https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Should.20.60IsDedekindDomain.60.20extend.20.60IsDomain.60.3F\r\n\r\n---\r\n<!-- The text above the `---` will become the commit message when your\r\nPR is merged. Please leave a blank newline before the `---`, otherwise\r\nGitHub will format the text above it as a title.\r\n\r\nTo indicate co-authors, include lines at the bottom of the commit message\r\n(that is, before the `---`) using the following format:\r\n\r\nCo-authored-by: Author Name <author@email.com>\r\n\r\nAny other comments you want to keep out of the PR commit should go\r\nbelow the `---`, and placed outside this HTML comment, or else they\r\nwill be invisible to reviewers.\r\n\r\nIf this PR depends on other PRs, please list them below this comment,\r\nusing the following format:\r\n- [ ] depends on: #abc [optional extra text]\r\n- [ ] depends on: #xyz [optional extra text]\r\n-->\r\n\r\n- [x] depends on: #5834 \r\n\r\n[![Open in Gitpod](https://gitpod.io/button/open-in-gitpod.svg)](https://gitpod.io/from-referrer/)\r\n",
        "changedFiles": 2,
        "closed": true,
        "closedAt": "2023-09-14T11:42:45Z",
        "comments": {
          "nodes": [
            {
              "id": "IC_kwDOFcwZ1c5j56F5",
              "body": "This PR/issue depends on:\n* ~~leanprover-community/mathlib4#5834~~\nBy **[Dependent Issues](https://github.com/z0al/dependent-issues)** (ðŸ¤–). Happy coding!\n<!-- By Dependent Issues (Action) - DO NOT REMOVE -->",
              "createdAt": "2023-08-12T22:19:18Z",
              "author": {
                "login": "leanprover-community-mathlib4-bot"
              }
            },
            {
              "id": "IC_kwDOFcwZ1c5mekz7",
              "body": "Pull request successfully merged into master.\n\n  Build succeeded!\n\n  The publicly hosted instance of bors-ng is deprecated and will go away soon.\n\n  If you want to self-host your own instance, [instructions are here][instructions].\n  For more help, visit [the forum].\n\n  If you want to switch to GitHub's built-in merge queue, visit [their help page][gh].\n\n  [instructions]: https://github.com/bors-ng/bors-ng#how-to-set-up-your-own-real-instance\n  [the forum]: https://forum.bors.tech\n  [gh]: https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-pull-request-merges/managing-a-merge-queue\n\n\n\n  * [Build](https://github.com/leanprover-community/mathlib4/actions/runs/6184027774/job/16786918827)\n  * [Check all files imported](https://github.com/leanprover-community/mathlib4/actions/runs/6184027774/job/16786919063)\n  * [Lint style](https://github.com/leanprover-community/mathlib4/actions/runs/6184027774/job/16786918606)",
              "createdAt": "2023-09-14T11:42:43Z",
              "author": {
                "login": "bors"
              }
            }
          ]
        },
        "commits": {
          "nodes": [
            {
              "commit": {
                "oid": "dcbf08ed65045695cd468dd1a3b8a112388a1ab3",
                "additions": 6,
                "deletions": 6,
                "committedDate": "2023-09-12T10:12:40Z",
                "author": {
                  "name": "Vierkantor",
                  "email": "vierkantor@vierkantor.com"
                },
                "statusCheckRollup": null
              }
            },
            {
              "commit": {
                "oid": "91dc1cce8fee4380e1e73a4d0a6643336e7dfa2b",
                "additions": 1,
                "deletions": 1,
                "committedDate": "2023-09-12T10:12:40Z",
                "author": {
                  "name": "Vierkantor",
                  "email": "vierkantor@vierkantor.com"
                },
                "statusCheckRollup": null
              }
            }
          ]
        },
        "createdAt": "2023-07-25T10:10:21Z",
        "deletions": 7,
        "files": {
          "nodes": [
            {
              "path": "Mathlib/RingTheory/Discriminant.lean",
              "additions": 1,
              "deletions": 1
            },
            {
              "path": "Mathlib/RingTheory/IntegrallyClosed.lean",
              "additions": 6,
              "deletions": 6
            }
          ]
        },
        "headRefName": "integrallyClosed-minus-domain",
        "headRefOid": "91dc1cce8fee4380e1e73a4d0a6643336e7dfa2b",
        "headRepository": {
          "name": "mathlib4",
          "owner": {
            "login": "leanprover-community"
          }
        },
        "headRepositoryOwner": {
          "login": "leanprover-community"
        },
        "id": "PR_kwDOFcwZ1c5WULR-",
        "isCrossRepository": false,
        "isDraft": false,
        "labels": {
          "nodes": [
            {
              "id": "LA_kwDOFcwZ1c8AAAABHuWjJg",
              "color": "06e039",
              "name": "ready-to-merge"
            },
            {
              "id": "LA_kwDOFcwZ1c8AAAABViJjTQ",
              "color": "33DBEC",
              "name": "t-algebra"
            }
          ]
        },
        "latestReviews": {
          "nodes": [
            {
              "id": "PRR_kwDOFcwZ1c5g8UMC",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "jcommelin"
              },
              "submittedAt": "2023-09-14T09:12:13Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5gqj_z",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "ericrbg"
              },
              "submittedAt": "2023-09-12T09:26:15Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5fKZT9",
              "body": "",
              "state": "APPROVED",
              "author": {
                "login": "alreadydone"
              },
              "submittedAt": "2023-08-25T22:16:55Z"
            }
          ]
        },
        "maintainerCanModify": false,
        "mergeCommit": null,
        "mergeStateStatus": "UNKNOWN",
        "mergeable": "UNKNOWN",
        "mergedAt": null,
        "mergedBy": null,
        "milestone": null,
        "number": 6126,
        "potentialMergeCommit": null,
        "projectCards": {
          "nodes": []
        },
        "reactionGroups": [
          {
            "content": "THUMBS_UP",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "THUMBS_DOWN",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "LAUGH",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "HOORAY",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "CONFUSED",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "HEART",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "ROCKET",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "EYES",
            "users": {
              "nodes": []
            }
          }
        ],
        "reviewDecision": "APPROVED",
        "reviewRequests": {
          "nodes": []
        },
        "reviews": {
          "nodes": [
            {
              "id": "PRR_kwDOFcwZ1c5fJzSv",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "alreadydone"
              },
              "submittedAt": "2023-08-25T19:44:37Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5fKZT9",
              "body": "",
              "state": "APPROVED",
              "author": {
                "login": "alreadydone"
              },
              "submittedAt": "2023-08-25T22:16:55Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5gqj_z",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "ericrbg"
              },
              "submittedAt": "2023-09-12T09:26:15Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5gqwjD",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "jcommelin"
              },
              "submittedAt": "2023-09-12T09:52:43Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5gq0ol",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "Vierkantor"
              },
              "submittedAt": "2023-09-12T10:01:42Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5grp32",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "Vierkantor"
              },
              "submittedAt": "2023-09-12T11:48:27Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5g8TKL",
              "body": "Thanks :tada:\r\n\r\nbors merge",
              "state": "APPROVED",
              "author": {
                "login": "jcommelin"
              },
              "submittedAt": "2023-09-14T09:10:05Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5g8UMC",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "jcommelin"
              },
              "submittedAt": "2023-09-14T09:12:13Z"
            }
          ]
        },
        "reviewThreads": {
          "nodes": [
            {
              "comments": {
                "nodes": [
                  {
                    "id": "PRRC_kwDOFcwZ1c5N2U7l",
                    "body": "In the Stacks Project, integral closedness is defined for any Algebra, not necessarily the FractionRing over the base ring: https://stacks.math.columbia.edu/tag/00GP Maybe we should change IsIntegrallyClosed to take the algebra as an argument and show that it's equivalent to [integralClosure](https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/IntegralClosure.html#integralClosure) being \\top?\r\n\r\nThe current definition (with the IsDomain condition) is called [Normal](https://stacks.math.columbia.edu/tag/0309) domains in Stacks. A [normal *ring*](https://stacks.math.columbia.edu/tag/00GV) means that localizations at all prime ideals are normal domains. This [implies](https://stacks.math.columbia.edu/tag/034M) integral closedness in its FractionRing, but is equivalent to it only [under some conditions](https://stacks.math.columbia.edu/tag/030C) (reduced + finitely many minimal primes), in which case it's also equivalent to being a finite product of normal domains. Whether we use Normal or IntegrallyClosed (in FractionRing) in the definition of IsDedekindRing, it looks like we'd need to add these conditions if we want exactly the products of Dedekind domains.\r\n\r\n(Edit: Hmmm in fact noetherianity is sufficient to guarantee finitely many minimal primes, so IsDedekindRing could be defined as IsReduced, IsNoetherian, Ring.DimensionLEOne, and either IsIntegrallyClosed or Normal. If we use Normal then IsReduced is automatic, but we could also consider a version of Normal that only requires the localizations are IntegrallyClosed in their FractionRings but may not be domains, and that may not equivalent to the ring itself being IntegallyClosed in its FractionRing (even for noetherian rings?).)",
                    "createdAt": "2023-08-25T19:44:37Z",
                    "author": {
                      "login": "alreadydone"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5N2s20",
                    "body": "I've now found [a paper](https://www.ams.org/journals/proc/1989-105-04/S0002-9939-1989-0942636-0/S0002-9939-1989-0942636-0.pdf) in which integrally-closedness is defined for a general commutative ring to mean it's integrally closed in its FractionRing. Therefore I think this PR is reasonable.",
                    "createdAt": "2023-08-25T22:16:50Z",
                    "author": {
                      "login": "alreadydone"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5O13v9",
                    "body": "Just because such a paper exists doesn't mean the definition is right, however? I think it's still fine to go ahead with this PR, but maybe it'd be nice to leave a note about all this for future work to maybe change this.\r\n\r\nI do worry that actually this future definition that is defined for any algebra will cause issues with typeclass search, but I guess that can be seen in the future.",
                    "createdAt": "2023-09-12T09:26:15Z",
                    "author": {
                      "login": "ericrbg"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5O1_z9",
                    "body": "I agree that it would be good to record most of Junyan's comment here on GH into a comment in the source. @alreadydone @Vierkantor could one of you do that please?",
                    "createdAt": "2023-09-12T09:52:43Z",
                    "author": {
                      "login": "jcommelin"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5O2Cdl",
                    "body": "Defining `IsIntegrallyClosed` with respect to any `Algebra` would probably work fine, at the cost of having to insert more parameters. How about I make a follow-up PR to this one that does that, and we can see separately how much has to be changed to do that? And whoever needs normal domains and rings can then build on that result :)",
                    "createdAt": "2023-09-12T10:01:42Z",
                    "author": {
                      "login": "Vierkantor"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5O2ibP",
                    "body": "Done: #7116",
                    "createdAt": "2023-09-12T11:48:27Z",
                    "author": {
                      "login": "Vierkantor"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5PA64O",
                    "body": "Thanks!",
                    "createdAt": "2023-09-14T09:12:13Z",
                    "author": {
                      "login": "jcommelin"
                    }
                  }
                ]
              }
            }
          ]
        },
        "closingIssuesReferences": {
          "nodes": []
        },
        "participants": {
          "nodes": [
            {
              "id": "MDQ6VXNlcjIxMTY1NzA=",
              "login": "Vierkantor"
            },
            {
              "id": "U_kgDOB75MNQ",
              "login": "leanprover-community-mathlib4-bot"
            },
            {
              "id": "MDQ6VXNlcjMwNjQxNDU=",
              "login": "alreadydone"
            },
            {
              "id": "MDQ6VXNlcjU2MzY3MDU=",
              "login": "jcommelin"
            },
            {
              "id": "MDQ6VXNlcjM3OTg0ODUx",
              "login": "ericrbg"
            },
            {
              "id": "MDQ6VXNlcjQ3Nzk1Ng==",
              "login": "kim-em"
            }
          ]
        },
        "state": "CLOSED",
        "statusCheckRollup": null,
        "title": "[Merged by Bors] - refactor: remove `IsDomain` hypothesis from `IsIntegrallyClosed`",
        "updatedAt": "2023-09-14T11:42:58Z",
        "url": "https://github.com/leanprover-community/mathlib4/pull/6126",
        "timelineItems": {
          "nodes": [
            {
              "__typename": "LabeledEvent",
              "id": "LE_lADOFcwZ1c5seuIpzwAAAAJOqluy",
              "createdAt": "2023-07-25T10:10:21Z",
              "label": {
                "id": "LA_kwDOFcwZ1c7ECuhA",
                "name": "awaiting-review"
              }
            },
            {
              "__typename": "LabeledEvent",
              "id": "LE_lADOFcwZ1c5seuIpzwAAAAJOqlu_",
              "createdAt": "2023-07-25T10:10:22Z",
              "label": {
                "id": "LA_kwDOFcwZ1c8AAAABKteTVQ",
                "name": "awaiting-CI"
              }
            },
            {
              "__typename": "LabeledEvent",
              "id": "LE_lADOFcwZ1c5seuIpzwAAAAJOqmuk",
              "createdAt": "2023-07-25T10:10:49Z",
              "label": {
                "id": "MDU6TGFiZWwzMjg4OTQyMDg2",
                "name": "blocked-by-other-PR"
              }
            },
            {
              "__typename": "CrossReferencedEvent",
              "id": "CRE_kwDOFcwZ1c5Nqn-c",
              "createdAt": "2023-07-25T10:40:35Z",
              "source": {
                "id": "PR_kwDOFcwZ1c5WUYaV",
                "title": "[Merged by Bors] - feat: `IsDedekindRing` is `IsDedekindDomain` minus `IsDomain`",
                "url": "https://github.com/leanprover-community/mathlib4/pull/6127"
              }
            },
            {
              "__typename": "UnlabeledEvent",
              "id": "UNLE_lADOFcwZ1c5seuIpzwAAAAJPnwv6",
              "createdAt": "2023-07-26T15:29:55Z",
              "label": {
                "id": "LA_kwDOFcwZ1c8AAAABKteTVQ",
                "name": "awaiting-CI"
              }
            },
            {
              "__typename": "LabeledEvent",
              "id": "LE_lADOFcwZ1c5seuIpzwAAAAJVBXKc",
              "createdAt": "2023-08-06T01:14:29Z",
              "label": {
                "id": "LA_kwDOFcwZ1c8AAAABViJjTQ",
                "name": "t-algebra"
              }
            },
            {
              "__typename": "LabeledEvent",
              "id": "LE_lADOFcwZ1c5seuIpzwAAAAJX4DVy",
              "createdAt": "2023-08-10T21:38:37Z",
              "label": {
                "id": "LA_kwDOFcwZ1c8AAAABIFoUmw",
                "name": "merge-conflict"
              }
            },
            {
              "__typename": "UnlabeledEvent",
              "id": "UNLE_lADOFcwZ1c5seuIpzwAAAAJYti8U",
              "createdAt": "2023-08-12T22:19:17Z",
              "label": {
                "id": "MDU6TGFiZWwzMjg4OTQyMDg2",
                "name": "blocked-by-other-PR"
              }
            },
            {
              "__typename": "IssueComment",
              "id": "IC_kwDOFcwZ1c5j56F5",
              "createdAt": "2023-08-12T22:19:18Z",
              "body": "This PR/issue depends on:\n* ~~leanprover-community/mathlib4#5834~~\nBy **[Dependent Issues](https://github.com/z0al/dependent-issues)** (ðŸ¤–). Happy coding!\n<!-- By Dependent Issues (Action) - DO NOT REMOVE -->",
              "author": {
                "login": "leanprover-community-mathlib4-bot"
              }
            },
            {
              "__typename": "HeadRefForcePushedEvent",
              "id": "HRFPE_lADOFcwZ1c5seuIpzwAAAAJcuVTi",
              "createdAt": "2023-08-21T13:32:55Z"
            },
            {
              "__typename": "UnlabeledEvent",
              "id": "UNLE_lADOFcwZ1c5seuIpzwAAAAJcuZGq",
              "createdAt": "2023-08-21T13:34:09Z",
              "label": {
                "id": "LA_kwDOFcwZ1c8AAAABIFoUmw",
                "name": "merge-conflict"
              }
            },
            {
              "__typename": "PullRequestReview",
              "id": "PRR_kwDOFcwZ1c5fJzSv",
              "createdAt": "2023-08-25T19:44:37Z",
              "body": "",
              "author": {
                "login": "alreadydone"
              }
            },
            {
              "__typename": "PullRequestReview",
              "id": "PRR_kwDOFcwZ1c5fKZT9",
              "createdAt": "2023-08-25T22:16:50Z",
              "body": "",
              "author": {
                "login": "alreadydone"
              }
            },
            {
              "__typename": "PullRequestCommit",
              "commit": {
                "oid": "dcbf08ed65045695cd468dd1a3b8a112388a1ab3"
              }
            },
            {
              "__typename": "PullRequestCommit",
              "commit": {
                "oid": "91dc1cce8fee4380e1e73a4d0a6643336e7dfa2b"
              }
            },
            {
              "__typename": "HeadRefForcePushedEvent",
              "id": "HRFPE_lADOFcwZ1c5seuIpzwAAAAJol5Eh",
              "createdAt": "2023-09-12T10:12:55Z"
            },
            {
              "__typename": "CrossReferencedEvent",
              "id": "CRE_kwDOFcwZ1c5OYKs5",
              "createdAt": "2023-09-12T11:46:42Z",
              "source": {
                "id": "PR_kwDOFcwZ1c5aHto0",
                "title": "refactor: generalize IsIntegrallyClosed away from fraction fields",
                "url": "https://github.com/leanprover-community/mathlib4/pull/7116"
              }
            },
            {
              "__typename": "PullRequestReview",
              "id": "PRR_kwDOFcwZ1c5g8TKL",
              "createdAt": "2023-09-14T09:10:05Z",
              "body": "Thanks :tada:\r\n\r\nbors merge",
              "author": {
                "login": "jcommelin"
              }
            },
            {
              "__typename": "LabeledEvent",
              "id": "LE_lADOFcwZ1c5seuIpzwAAAAJqE1jt",
              "createdAt": "2023-09-14T09:10:18Z",
              "label": {
                "id": "LA_kwDOFcwZ1c8AAAABHuWjJg",
                "name": "ready-to-merge"
              }
            },
            {
              "__typename": "UnlabeledEvent",
              "id": "UNLE_lADOFcwZ1c5seuIpzwAAAAJqE1nJ",
              "createdAt": "2023-09-14T09:10:19Z",
              "label": {
                "id": "LA_kwDOFcwZ1c7ECuhA",
                "name": "awaiting-review"
              }
            },
            {
              "__typename": "ReferencedEvent"
            },
            {
              "__typename": "IssueComment",
              "id": "IC_kwDOFcwZ1c5mekz7",
              "createdAt": "2023-09-14T11:42:43Z",
              "body": "Pull request successfully merged into master.\n\n  Build succeeded!\n\n  The publicly hosted instance of bors-ng is deprecated and will go away soon.\n\n  If you want to self-host your own instance, [instructions are here][instructions].\n  For more help, visit [the forum].\n\n  If you want to switch to GitHub's built-in merge queue, visit [their help page][gh].\n\n  [instructions]: https://github.com/bors-ng/bors-ng#how-to-set-up-your-own-real-instance\n  [the forum]: https://forum.bors.tech\n  [gh]: https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-pull-request-merges/managing-a-merge-queue\n\n\n\n  * [Build](https://github.com/leanprover-community/mathlib4/actions/runs/6184027774/job/16786918827)\n  * [Check all files imported](https://github.com/leanprover-community/mathlib4/actions/runs/6184027774/job/16786919063)\n  * [Lint style](https://github.com/leanprover-community/mathlib4/actions/runs/6184027774/job/16786918606)",
              "author": {
                "login": "bors"
              }
            },
            {
              "__typename": "RenamedTitleEvent"
            },
            {
              "__typename": "ClosedEvent",
              "id": "CE_lADOFcwZ1c5seuIpzwAAAAJqLDVW",
              "createdAt": "2023-09-14T11:42:45Z"
            },
            {
              "__typename": "HeadRefDeletedEvent",
              "id": "HRDE_lADOFcwZ1c5seuIpzwAAAAJqLDxv",
              "createdAt": "2023-09-14T11:42:58Z"
            },
            {
              "__typename": "ReferencedEvent"
            }
          ]
        }
      }
    }
  }
}
