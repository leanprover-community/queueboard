{
  "data": {
    "repository": {
      "pullRequest": {
        "additions": 5,
        "assignees": {
          "nodes": []
        },
        "author": {
          "login": "digama0"
        },
        "autoMergeRequest": null,
        "baseRefName": "master",
        "body": "These files are new in v4.1.0. If we don't cache them (or regenerate them, but they are tiny files so there is no reason not to cache them) then lake gets messed up unless you use the `-R` option in the next `lake build`.\r\n\r\n---\r\n<!-- The text above the `---` will become the commit message when your\r\nPR is merged. Please leave a blank newline before the `---`, otherwise\r\nGitHub will format the text above it as a title.\r\n\r\nTo indicate co-authors, include lines at the bottom of the commit message\r\n(that is, before the `---`) using the following format:\r\n\r\nCo-authored-by: Author Name <author@email.com>\r\n\r\nAny other comments you want to keep out of the PR commit should go\r\nbelow the `---`, and placed outside this HTML comment, or else they\r\nwill be invisible to reviewers.\r\n\r\nIf this PR depends on other PRs, please list them below this comment,\r\nusing the following format:\r\n- [ ] depends on: #abc [optional extra text]\r\n- [ ] depends on: #xyz [optional extra text]\r\n-->\r\n\r\n[![Open in Gitpod](https://gitpod.io/button/open-in-gitpod.svg)](https://gitpod.io/from-referrer/)\r\n",
        "changedFiles": 2,
        "closed": true,
        "closedAt": "2023-09-21T15:29:24Z",
        "comments": {
          "nodes": [
            {
              "id": "IC_kwDOFcwZ1c5nFRqh",
              "body": ":v: digama0 can now approve this pull request. To approve and merge a pull request, simply reply with `bors r+`. More detailed instructions are available [here](https://bors.tech/documentation/getting-started/#reviewing-pull-requests).",
              "createdAt": "2023-09-21T12:05:50Z",
              "author": {
                "login": "bors"
              }
            },
            {
              "id": "IC_kwDOFcwZ1c5nGHjD",
              "body": "bors r+",
              "createdAt": "2023-09-21T14:06:19Z",
              "author": {
                "login": "digama0"
              }
            },
            {
              "id": "IC_kwDOFcwZ1c5nGulZ",
              "body": "Pull request successfully merged into master.\n\n  Build succeeded!\n\n  The publicly hosted instance of bors-ng is deprecated and will go away soon.\n\n  If you want to self-host your own instance, [instructions are here][instructions].\n  For more help, visit [the forum].\n\n  If you want to switch to GitHub's built-in merge queue, visit [their help page][gh].\n\n  [instructions]: https://github.com/bors-ng/bors-ng#how-to-set-up-your-own-real-instance\n  [the forum]: https://forum.bors.tech\n  [gh]: https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-pull-request-merges/managing-a-merge-queue\n\n\n\n  * [Build](https://github.com/leanprover-community/mathlib4/actions/runs/6262816411/job/17005854938)\n  * [Check all files imported](https://github.com/leanprover-community/mathlib4/actions/runs/6262816411/job/17005855348)\n  * [Lint style](https://github.com/leanprover-community/mathlib4/actions/runs/6262816411/job/17005854589)",
              "createdAt": "2023-09-21T15:29:22Z",
              "author": {
                "login": "bors"
              }
            }
          ]
        },
        "commits": {
          "nodes": [
            {
              "commit": {
                "oid": "b84ef02f9306e04659ef64659dc394b50199b2dc",
                "additions": 4,
                "deletions": 1,
                "committedDate": "2023-09-21T11:02:58Z",
                "author": {
                  "name": "Mario Carneiro",
                  "email": "di.gama@gmail.com"
                },
                "statusCheckRollup": null
              }
            },
            {
              "commit": {
                "oid": "bf57f132a9e3cd72dc4c257df6d09a1260a2babf",
                "additions": 1,
                "deletions": 1,
                "committedDate": "2023-09-21T12:54:38Z",
                "author": {
                  "name": "Mario Carneiro",
                  "email": "di.gama@gmail.com"
                },
                "statusCheckRollup": null
              }
            }
          ]
        },
        "createdAt": "2023-09-21T11:08:36Z",
        "deletions": 2,
        "files": {
          "nodes": [
            {
              "path": "Cache/IO.lean",
              "additions": 4,
              "deletions": 1
            },
            {
              "path": "lake-manifest.json",
              "additions": 1,
              "deletions": 1
            }
          ]
        },
        "headRefName": "cache_hash",
        "headRefOid": "bf57f132a9e3cd72dc4c257df6d09a1260a2babf",
        "headRepository": {
          "name": "mathlib4",
          "owner": {
            "login": "leanprover-community"
          }
        },
        "headRepositoryOwner": {
          "login": "leanprover-community"
        },
        "id": "PR_kwDOFcwZ1c5a4BSL",
        "isCrossRepository": false,
        "isDraft": false,
        "labels": {
          "nodes": [
            {
              "id": "LA_kwDOFcwZ1c8AAAABHuWjJg",
              "color": "06e039",
              "name": "ready-to-merge"
            }
          ]
        },
        "latestReviews": {
          "nodes": [
            {
              "id": "PRR_kwDOFcwZ1c5hm0Tq",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "Kha"
              },
              "submittedAt": "2023-09-21T11:13:00Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5hnyfy",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "eric-wieser"
              },
              "submittedAt": "2023-09-21T13:21:10Z"
            }
          ]
        },
        "maintainerCanModify": false,
        "mergeCommit": null,
        "mergeStateStatus": "UNKNOWN",
        "mergeable": "UNKNOWN",
        "mergedAt": null,
        "mergedBy": null,
        "milestone": null,
        "number": 7291,
        "potentialMergeCommit": null,
        "projectCards": {
          "nodes": []
        },
        "reactionGroups": [
          {
            "content": "THUMBS_UP",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "THUMBS_DOWN",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "LAUGH",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "HOORAY",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "CONFUSED",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "HEART",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "ROCKET",
            "users": {
              "nodes": []
            }
          },
          {
            "content": "EYES",
            "users": {
              "nodes": []
            }
          }
        ],
        "reviewDecision": "APPROVED",
        "reviewRequests": {
          "nodes": []
        },
        "reviews": {
          "nodes": [
            {
              "id": "PRR_kwDOFcwZ1c5hm0Mn",
              "body": "",
              "state": "APPROVED",
              "author": {
                "login": "Kha"
              },
              "submittedAt": "2023-09-21T11:12:45Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5hm0Tq",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "Kha"
              },
              "submittedAt": "2023-09-21T11:13:00Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5hm0j_",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "digama0"
              },
              "submittedAt": "2023-09-21T11:13:39Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5hnKci",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "eric-wieser"
              },
              "submittedAt": "2023-09-21T12:05:49Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5hnNg5",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "digama0"
              },
              "submittedAt": "2023-09-21T12:12:58Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5hnciy",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "eric-wieser"
              },
              "submittedAt": "2023-09-21T12:44:20Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5hnlpL",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "digama0"
              },
              "submittedAt": "2023-09-21T13:02:39Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5hnyfy",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "eric-wieser"
              },
              "submittedAt": "2023-09-21T13:21:10Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5hnz4l",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "digama0"
              },
              "submittedAt": "2023-09-21T13:23:46Z"
            },
            {
              "id": "PRR_kwDOFcwZ1c5hoOc_",
              "body": "",
              "state": "COMMENTED",
              "author": {
                "login": "digama0"
              },
              "submittedAt": "2023-09-21T14:07:08Z"
            }
          ]
        },
        "reviewThreads": {
          "nodes": [
            {
              "comments": {
                "nodes": [
                  {
                    "id": "PRRC_kwDOFcwZ1c5Pck31",
                    "body": "Why does it?",
                    "createdAt": "2023-09-21T11:13:00Z",
                    "author": {
                      "login": "Kha"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5PclCk",
                    "body": "it is pattern matched down below, the trace file has a special place in the LTAR format",
                    "createdAt": "2023-09-21T11:13:39Z",
                    "author": {
                      "login": "digama0"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5PcypC",
                    "body": "The match in question is:\r\n```lean\r\n          let trace :: args := (← buildPaths.filterM (·.1.pathExists)) |>.map (·.1.toString)\r\n            | unreachable!\r\n```\r\nProbably this could be written in a way that makes it clearer, but that's orthogonal to this PR.\r\n\r\nbors d+\r\n\r\nI assume you tested this solves the problem?",
                    "createdAt": "2023-09-21T12:05:48Z",
                    "author": {
                      "login": "eric-wieser"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5Pc0jC",
                    "body": "I tested that it is packing / unpacking the .hash files as expected, but I have not reproduced the initial bad cache issue so I can't say I have checked that this fixes it. (But it is very obvious to me that the original implementation would mess lake up and this is a necessary condition for fixing the bug.)",
                    "createdAt": "2023-09-21T12:12:58Z",
                    "author": {
                      "login": "digama0"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5PdcVs",
                    "body": "The updated version has been tested to work with `lake exe cache get && lake build`.",
                    "createdAt": "2023-09-21T14:07:08Z",
                    "author": {
                      "login": "digama0"
                    }
                  }
                ]
              }
            },
            {
              "comments": {
                "nodes": [
                  {
                    "id": "PRRC_kwDOFcwZ1c5Pc-Cn",
                    "body": "This should be in the master yaml file",
                    "createdAt": "2023-09-21T12:44:20Z",
                    "author": {
                      "login": "eric-wieser"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5PdDvq",
                    "body": "this is not going to be committed, it is just kicking CI (and it didn't work anyway because of https://github.com/leanprover/lake/issues/181). The alternative is the commit I just pushed, which invalidates the cache by adding whitespace in the lake manifest. I do plan to commit that, because it is important that anything downstream of this commit not get old caches because they will poison the new caches in CI.",
                    "createdAt": "2023-09-21T13:02:39Z",
                    "author": {
                      "login": "digama0"
                    }
                  }
                ]
              }
            },
            {
              "comments": {
                "nodes": [
                  {
                    "id": "PRRC_kwDOFcwZ1c5PdLPU",
                    "body": "Does lake / lean-cache hash the textual content of this file, as opposed to hashing the decoded json?",
                    "createdAt": "2023-09-21T13:21:10Z",
                    "author": {
                      "login": "eric-wieser"
                    }
                  },
                  {
                    "id": "PRRC_kwDOFcwZ1c5PdMFJ",
                    "body": "`cache` hashes the text. `lake` doesn't hash it at all, but this is fine because we are only trying to invalidate the cache here",
                    "createdAt": "2023-09-21T13:23:46Z",
                    "author": {
                      "login": "digama0"
                    }
                  }
                ]
              }
            }
          ]
        },
        "closingIssuesReferences": {
          "nodes": []
        },
        "participants": {
          "nodes": [
            {
              "id": "MDQ6VXNlcjg2ODU4OA==",
              "login": "digama0"
            },
            {
              "id": "MDQ6VXNlcjEwOTEyNg==",
              "login": "Kha"
            },
            {
              "id": "MDQ6VXNlcjQyNTI2MA==",
              "login": "eric-wieser"
            }
          ]
        },
        "state": "CLOSED",
        "statusCheckRollup": null,
        "title": "[Merged by Bors] - fix: add .hash files to the cache",
        "updatedAt": "2023-09-21T15:29:28Z",
        "url": "https://github.com/leanprover-community/mathlib4/pull/7291",
        "timelineItems": {
          "nodes": [
            {
              "__typename": "PullRequestCommit",
              "commit": {
                "oid": "b84ef02f9306e04659ef64659dc394b50199b2dc"
              }
            },
            {
              "__typename": "PullRequestReview",
              "id": "PRR_kwDOFcwZ1c5hm0Mn",
              "createdAt": "2023-09-21T11:12:45Z",
              "body": "",
              "author": {
                "login": "Kha"
              }
            },
            {
              "__typename": "PullRequestReview",
              "id": "PRR_kwDOFcwZ1c5hm0Tq",
              "createdAt": "2023-09-21T11:13:00Z",
              "body": "",
              "author": {
                "login": "Kha"
              }
            },
            {
              "__typename": "IssueComment",
              "id": "IC_kwDOFcwZ1c5nFRqh",
              "createdAt": "2023-09-21T12:05:50Z",
              "body": ":v: digama0 can now approve this pull request. To approve and merge a pull request, simply reply with `bors r+`. More detailed instructions are available [here](https://bors.tech/documentation/getting-started/#reviewing-pull-requests).",
              "author": {
                "login": "bors"
              }
            },
            {
              "__typename": "HeadRefForcePushedEvent",
              "id": "HRFPE_lADOFcwZ1c5xphnSzwAAAAJt9VUL",
              "createdAt": "2023-09-21T12:24:33Z"
            },
            {
              "__typename": "PullRequestReview",
              "id": "PRR_kwDOFcwZ1c5hnciy",
              "createdAt": "2023-09-21T12:44:20Z",
              "body": "",
              "author": {
                "login": "eric-wieser"
              }
            },
            {
              "__typename": "PullRequestCommit",
              "commit": {
                "oid": "bf57f132a9e3cd72dc4c257df6d09a1260a2babf"
              }
            },
            {
              "__typename": "HeadRefForcePushedEvent",
              "id": "HRFPE_lADOFcwZ1c5xphnSzwAAAAJt-onW",
              "createdAt": "2023-09-21T12:54:46Z"
            },
            {
              "__typename": "PullRequestReview",
              "id": "PRR_kwDOFcwZ1c5hnyfy",
              "createdAt": "2023-09-21T13:21:10Z",
              "body": "",
              "author": {
                "login": "eric-wieser"
              }
            },
            {
              "__typename": "IssueComment",
              "id": "IC_kwDOFcwZ1c5nGHjD",
              "createdAt": "2023-09-21T14:06:19Z",
              "body": "bors r+",
              "author": {
                "login": "digama0"
              }
            },
            {
              "__typename": "LabeledEvent",
              "id": "LE_lADOFcwZ1c5xphnSzwAAAAJuCq59",
              "createdAt": "2023-09-21T14:06:35Z",
              "label": {
                "id": "LA_kwDOFcwZ1c8AAAABHuWjJg",
                "name": "ready-to-merge"
              }
            },
            {
              "__typename": "ReferencedEvent"
            },
            {
              "__typename": "IssueComment",
              "id": "IC_kwDOFcwZ1c5nGulZ",
              "createdAt": "2023-09-21T15:29:22Z",
              "body": "Pull request successfully merged into master.\n\n  Build succeeded!\n\n  The publicly hosted instance of bors-ng is deprecated and will go away soon.\n\n  If you want to self-host your own instance, [instructions are here][instructions].\n  For more help, visit [the forum].\n\n  If you want to switch to GitHub's built-in merge queue, visit [their help page][gh].\n\n  [instructions]: https://github.com/bors-ng/bors-ng#how-to-set-up-your-own-real-instance\n  [the forum]: https://forum.bors.tech\n  [gh]: https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-pull-request-merges/managing-a-merge-queue\n\n\n\n  * [Build](https://github.com/leanprover-community/mathlib4/actions/runs/6262816411/job/17005854938)\n  * [Check all files imported](https://github.com/leanprover-community/mathlib4/actions/runs/6262816411/job/17005855348)\n  * [Lint style](https://github.com/leanprover-community/mathlib4/actions/runs/6262816411/job/17005854589)",
              "author": {
                "login": "bors"
              }
            },
            {
              "__typename": "RenamedTitleEvent"
            },
            {
              "__typename": "ClosedEvent",
              "id": "CE_lADOFcwZ1c5xphnSzwAAAAJuHIBM",
              "createdAt": "2023-09-21T15:29:24Z"
            },
            {
              "__typename": "HeadRefDeletedEvent",
              "id": "HRDE_lADOFcwZ1c5xphnSzwAAAAJuHIPq",
              "createdAt": "2023-09-21T15:29:28Z"
            },
            {
              "__typename": "CrossReferencedEvent",
              "id": "CRE_kwDOFcwZ1c5Ohlhn",
              "createdAt": "2023-09-21T15:38:14Z",
              "source": {
                "id": "PR_kwDOFcwZ1c5a5fvB",
                "title": "[Merged by Bors] - chore(Topology/SubsetProperties): rename isCompact_of_isClosed_subset",
                "url": "https://github.com/leanprover-community/mathlib4/pull/7298"
              }
            },
            {
              "__typename": "CrossReferencedEvent",
              "id": "CRE_kwDOFcwZ1c5OiFqn",
              "createdAt": "2023-09-22T01:27:00Z",
              "source": {
                "id": "PR_kwDOFcwZ1c5a8f6L",
                "title": "[Merged by Bors] - chore: add further comments in #7291",
                "url": "https://github.com/leanprover-community/mathlib4/pull/7317"
              }
            },
            {
              "__typename": "ReferencedEvent"
            },
            {
              "__typename": "ReferencedEvent"
            }
          ]
        }
      }
    }
  }
}
